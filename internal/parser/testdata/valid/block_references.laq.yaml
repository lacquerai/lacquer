version: "1.0"

metadata:
  name: "block-references-test"
  description: "Test various block reference formats"

agents:
  basic_agent:
    model: "gpt-4"
    
  lacquer_agent:
    uses: "lacquer/web-search@v1"
    
  github_agent:
    uses: "github.com/example/ai-tools@v2.1"
    
  local_agent:
    uses: "./custom/agents/specialist"

workflow:
  steps:
    - id: basic_step
      agent: basic_agent
      prompt: "Basic agent step"
      
    - id: lacquer_block_simple
      uses: "lacquer/http-request@v1"
      with:
        url: "https://api.example.com/data"
        method: "GET"
        
    - id: lacquer_block_versioned
      uses: "lacquer/postgresql@v2.0"
      with:
        query: "SELECT * FROM users"
        connection: "{{ env.DATABASE_URL }}"
        
    - id: github_block
      uses: "github.com/owner/repo@v1.0.0"
      with:
        config:
          key: "value"
          
    - id: github_block_no_version
      uses: "github.com/another/tool@main"
      with:
        parameters:
          setting: true
          
    - id: local_block_relative
      uses: "./blocks/custom-processor"
      with:
        input: "{{ steps.basic_step.output }}"
        
    - id: local_block_parent
      uses: "../shared/blocks/formatter"
      with:
        format: "json"
        data: "{{ steps.lacquer_block_simple.output }}"
        
    - id: agent_with_tools
      agent: basic_agent
      prompt: "Use tools to process data"
      tools:
        - name: "web_search"
          uses: "lacquer/web-search@v1"
        - name: "file_writer"
          uses: "lacquer/file-writer@v1"
        - name: "custom_tool"
          script: "python scripts/custom_tool.py"
        - name: "mcp_tool"
          mcp_server: "filesystem"