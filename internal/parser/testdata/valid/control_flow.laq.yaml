version: "1.0"

metadata:
  name: "control-flow-test"
  description: "Test control flow patterns"

agents:
  assistant:
    model: "gpt-4"

workflow:
  inputs:
    mode:
      type: "string"
      default: "normal"
    count:
      type: "integer"
      default: 1
      
  state:
    counter: 0
    status: "active"
    
  steps:
    - id: conditional_step
      agent: assistant
      prompt: "Execute conditional logic"
      condition: "{{ inputs.mode == 'advanced' }}"
      
    - id: skip_if_step
      agent: assistant
      prompt: "This step might be skipped"
      skip_if: "{{ state.counter > 5 }}"
      
    - id: complex_condition
      agent: assistant
      prompt: "Complex condition test"
      condition: "{{ inputs.count > 0 && state.status == 'active' }}"
      
    - id: state_update
      action: "update_state"
      updates:
        counter: "{{ state.counter + 1 }}"
        status: "normal"
        
    - id: dependent_step
      agent: assistant
      prompt: "Depends on previous state: {{ state.status }}"
      condition: "{{ state.counter }} < 10"
      
  outputs:
    final_count: "{{ state.counter }}"
    final_status: "{{ state.status }}"