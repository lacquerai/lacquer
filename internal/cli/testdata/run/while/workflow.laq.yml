version: "1.0"
metadata:
  name: while
  description: Test workflow for while loop


workflow:
  state:
    iterations: 0
    text: "begin"
  steps:
    - id: while_loop
      while: ${{ state.iterations < 3 }}
      steps:
        - id: print_text
          run: |
            echo "${{ state.text }}" inner
          updates:
            text: "${{ state.text }}, ${{ state.iterations }}"
            iterations: ${{ state.iterations + 1 }}

    - id: print_text
      run: |
        echo "${{ state.text }}"

  outputs:
    iterations: ${{ state.iterations }}
    text: ${{ state.text }}
    second_iterations: ${{ steps.while_loop.steps.print_text.output }}