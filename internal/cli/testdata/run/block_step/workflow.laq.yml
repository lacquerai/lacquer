version: "1.0"
metadata:
  name: block-step
  description: Test workflow for block execution (uses)
  author: lacquer-team

workflow:
  inputs:
    input_text:
      type: string
      description: Text to process through blocks
      default: "Hello World from Blocks!"
    
    first_operation:
      type: string
      description: First operation to perform
      default: "uppercase"
    
    second_operation:
      type: string
      description: Second operation to perform
      default: "reverse"

  steps:
    - id: first_processing
      uses: "./blocks/text_processor.laq.yml"
      with:
        text: "{{ inputs.input_text }}"
        operation: "{{ inputs.first_operation }}"
      outputs:
        result:
          type: string
          description: Result from first processing
        metadata:
          type: object
          description: Metadata about the processing

    - id: second_processing
      uses: "./blocks/text_processor.laq.yml"
      with:
        text: "{{ steps.first_processing.outputs.result }}"
        operation: "{{ inputs.second_operation }}"
      outputs:
        result:
          type: string
          description: Result from second processing
        metadata:
          type: object
          description: Metadata about the processing

    - id: length_check
      uses: "./blocks/text_processor.laq.yml"
      with:
        text: "{{ steps.second_processing.outputs.result }}"
        operation: "length"
      outputs:
        result:
          type: string
          description: Result from length check
        metadata:
          type: object
          description: Metadata about the processing

  outputs:
    original: "{{ inputs.input_text }}"
    first_transformation: "{{ steps.first_processing.outputs.result }}"
    second_transformation: "{{ steps.second_processing.outputs.result }}"
    final_length: "{{ steps.length_check.outputs.calculated_length }}"